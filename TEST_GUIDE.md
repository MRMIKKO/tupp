# 摇一摇功能快速测试指南

## 测试步骤

### 1. 本地测试（推荐）

使用本地服务器（支持HTTPS或localhost）：

```bash
# 方法1：Python
python -m http.server 8000

# 方法2：Node.js
npx serve

# 然后访问：http://localhost:8000
```

### 2. iOS设备测试

**预期流程**：
1. 在Safari中打开游戏
2. 点击"开始游戏"按钮
3. **立即弹出iOS系统权限对话框**："允许"游戏.html"访问运动与方向？"
4. 点击"允许"
5. 看到黑色提示框："✓ 摇一摇功能已启用"
6. 1.5秒后提示框消失，游戏开始
7. 摇动手机 → 清屏效果（无任何提示）

**如果没有弹窗**：
- 检查是否使用HTTPS（localhost除外）
- 检查Safari设置 → 隐私 → 运动与方向访问
- 尝试清除浏览器缓存重新加载

### 3. Android设备测试

**预期流程**：
1. 在Chrome/Firefox中打开游戏
2. 点击"开始游戏"按钮
3. 可能无权限弹窗，直接进入游戏
4. 摇动手机 → 清屏效果

**如果不工作**：
- 检查是否使用HTTPS
- 检查浏览器设置 → 网站设置 → 运动传感器
- 在Chrome中输入 `chrome://flags` 搜索 "sensor" 确保已启用

### 4. 控制台调试

打开浏览器控制台（F12或长按屏幕 → 检查），应该看到：

**点击开始游戏时**：
```
请求iOS设备运动权限...
权限请求结果: granted
✓ 设备运动权限已授予，摇一摇功能已启用
```

**摇动手机时**：
```
摇一摇触发！变化量: 15.24
⚡ 闪电技能激活！清除3个敌机
```

**技能冷却时**：
```
⚡ 技能冷却中... 还需 3 秒
```

**没有敌机时**：
```
⚡ 没有敌机可以清除
```

## 验证清单

- [ ] 点击"开始游戏"时出现权限提示（iOS）
- [ ] 授权后显示"✓ 摇一摇功能已启用"
- [ ] 提示框1.5秒后自动消失
- [ ] 游戏正常开始
- [ ] 摇动手机能触发清屏效果
- [ ] 游戏中没有任何弹窗提示
- [ ] 控制台有正确的日志输出
- [ ] 重新开始游戏会重新请求权限

## 常见问题快速解决

| 问题 | 解决方案 |
|------|---------|
| iOS无权限弹窗 | 确保使用HTTPS或localhost |
| 授权后不工作 | 检查控制台是否有传感器数据 |
| 摇动不触发 | 尝试更用力地摇动，或调低阈值 |
| 游戏中有提示 | 确认使用最新版本代码 |
| Android不支持 | 某些旧设备可能不支持，尝试更新浏览器 |

## 性能测试

1. **灵敏度测试**：轻微摇动 → 不应触发，用力摇动 → 应该触发
2. **冷却测试**：连续摇动 → 第二次应该提示冷却中（仅控制台）
3. **多次游戏**：重启游戏 → 应该重新请求权限
4. **无敌机测试**：刚开始游戏时摇动 → 应该无效果（仅控制台日志）

## 部署测试

### Vercel/Netlify部署
1. 部署到平台（自动启用HTTPS）
2. 用手机访问部署的URL
3. 按照上述流程测试

### 本地HTTPS测试
```bash
# 使用local-ssl-proxy
npx local-ssl-proxy --source 8443 --target 8000
# 访问 https://localhost:8443
```

## 成功标准

✅ **完美体验**：
- 点击开始游戏 → iOS弹窗 → 点击允许 → 简短提示 → 游戏开始
- 摇动手机 → 清屏效果（无提示）
- 技能冷却/无敌机 → 无UI提示，仅控制台日志

✅ **调试友好**：
- 控制台日志清晰
- 权限状态明确
- 错误信息详细

---

测试完成后请确认所有功能正常！
